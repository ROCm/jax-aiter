{
    "module_custom": {
        "srcs": [
            "f'{AITER_CSRC_DIR}/py_itfs_cu/custom.cu'",
            "f'{AITER_CSRC_DIR}/kernels/custom_kernels.cu'"
        ],
        "flags_extra_cc": [],
        "flags_extra_hip": [],
        "extra_ldflags": [],
        "extra_include": [],
        "verbose": "False",
        "blob_gen_cmd": "''"
    },
    "module_fmha_v3_fwd": {
        "srcs": [
            "f'{AITER_CSRC_DIR}/kernels/mha_common.cu'",
            "f'{AITER_CSRC_DIR}/py_itfs_cu/asm_mha_fwd.cu'"
        ],
        "flags_extra_cc": [],
        "flags_extra_hip": [
            "'-DCK_TILE_FMHA_FWD_FAST_EXP2=1'",
            "f'-DCK_TILE_FLOAT_TO_BFLOAT16_DEFAULT={os.environ.get(\"CK_TILE_FLOAT_TO_BFLOAT16_DEFAULT\", 2)}'"
        ],
        "extra_ldflags": [],
        "extra_include": [
            "f'{CK_DIR}/example/ck_tile/01_fmha'"
        ],
        "verbose": "False",
        "blob_gen_cmd": [
            "f'{AITER_CSRC_DIR}/cpp_itfs/mha_fwd_generate.py --receipt 1 --output_dir {{}}'",
            "f'{get_asm_dir()}/gfx942/fmha_v3_fwd/codegen.py --output_dir {{}}'",
            "f'{get_asm_dir()}/gfx950/fmha_v3_fwd/codegen.py --output_dir {{}}'"
        ]
    },
    "module_mha_fwd": {
        "srcs": [
            "f'{AITER_CSRC_DIR}/kernels/mha_common.cu'",
            "f'{AITER_CSRC_DIR}/py_itfs_ck/mha_fwd_kernels.cu'"
        ],
        "flags_extra_cc": [],
        "flags_extra_hip": [
            "'-DCK_TILE_FMHA_FWD_FAST_EXP2=1'",
            "f'-DCK_TILE_FLOAT_TO_BFLOAT16_DEFAULT={os.environ.get(\"CK_TILE_FLOAT_TO_BFLOAT16_DEFAULT\", 2)}'"
        ],
        "extra_ldflags": [],
        "extra_include": [
            "f'{CK_DIR}/example/ck_tile/01_fmha'"
        ],
        "verbose": "False",
        "hip_clang_path": "os.environ.get('MHA_HIP_CLANG_PATH')",
        "blob_gen_cmd": [
            "f'{CK_DIR}/example/ck_tile/01_fmha/generate.py -d fwd --receipt 600 --output_dir {{}}'",
            "f'{AITER_CSRC_DIR}/cpp_itfs/mha_fwd_generate.py --receipt 3 --output_dir {{}}'"
        ]
    },
    "module_mha_varlen_fwd": {
        "srcs": [
            "f'{AITER_CSRC_DIR}/kernels/mha_common.cu'",
            "f'{AITER_CSRC_DIR}/py_itfs_ck/mha_varlen_fwd_kernels.cu'"
        ],
        "flags_extra_cc": [],
        "flags_extra_hip": [
            "'-DCK_TILE_FMHA_FWD_FAST_EXP2=1'",
            "f'-DCK_TILE_FLOAT_TO_BFLOAT16_DEFAULT={os.environ.get(\"CK_TILE_FLOAT_TO_BFLOAT16_DEFAULT\", 2)}'",
            "f'-DCK_TILE_ATTENTION_LOGITS_SOFT_CAP_DEFAULT={os.environ.get(\"CK_TILE_ATTENTION_LOGITS_SOFT_CAP_DEFAULT\", 0)}'"
        ],
        "extra_ldflags": [],
        "extra_include": [
            "f'{CK_DIR}/example/ck_tile/01_fmha'"
        ],
        "verbose": "False",
        "hip_clang_path": "os.environ.get('MHA_HIP_CLANG_PATH')",
        "blob_gen_cmd": [
            "f'{CK_DIR}/example/ck_tile/01_fmha/generate.py -d fwd --receipt 600 --output_dir {{}}'",
            "f'{CK_DIR}/example/ck_tile/01_fmha/generate.py -d fwd_splitkv --receipt 600 --output_dir {{}}'",
            "f'{AITER_CSRC_DIR}/cpp_itfs/mha_fwd_generate.py --receipt 3 --output_dir {{}}'"
         ]
    },
    "module_mha_batch_prefill": {
        "srcs": [
            "f'{AITER_CSRC_DIR}/kernels/mha_common.cu'",
            "f'{AITER_CSRC_DIR}/py_itfs_ck/mha_batch_prefill_kernels.cu'"
        ],
        "flags_extra_cc": [],
        "flags_extra_hip": [
            "'-DCK_TILE_FMHA_FWD_FAST_EXP2=1'",
            "f'-DCK_TILE_FLOAT_TO_BFLOAT16_DEFAULT={os.environ.get(\"CK_TILE_FLOAT_TO_BFLOAT16_DEFAULT\", 2)}'",
            "f'-DCK_TILE_ATTENTION_LOGITS_SOFT_CAP_DEFAULT={os.environ.get(\"CK_TILE_ATTENTION_LOGITS_SOFT_CAP_DEFAULT\", 0)}'",
            "f'-DCK_TILE_ATTENTION_USE_SOFTSIGN_ASM={os.environ.get(\"CK_TILE_ATTENTION_USE_SOFTSIGN_ASM\", 1)}'"
        ],
        "extra_ldflags": [],
        "extra_include": [
            "f'{CK_DIR}/example/ck_tile/01_fmha'"
        ],
        "verbose": "False",
        "blob_gen_cmd": [
            "f'{CK_DIR}/example/ck_tile/01_fmha/generate.py -d batch_prefill --receipt 600 --output_dir {{}}'",
            "f'{AITER_CSRC_DIR}/cpp_itfs/mha_fwd_generate.py --receipt 5 --output_dir {{}}'"
        ]
    },
    "module_fmha_v3_bwd": {
        "srcs": [
            "f'{AITER_CSRC_DIR}/kernels/mha_common.cu'",
            "f'{AITER_CSRC_DIR}/py_itfs_cu/asm_mha_bwd.cu'"
        ],
        "flags_extra_cc": [],
        "flags_extra_hip": [
            "'-DCK_TILE_FMHA_FWD_FAST_EXP2=1'"
        ],
        "extra_ldflags": [],
        "extra_include": [
            "f'{CK_DIR}/example/ck_tile/01_fmha'"
        ],
        "verbose": "False",
        "blob_gen_cmd": [
            "f'{AITER_CSRC_DIR}/py_itfs_cu/fmha_bwd_pre_post_kernel_generate.py --filter \"*@*_ndeterministic@*_nbias*_dropout*_ndeterministic*\" --output_dir {{}}'",
            "f'{get_asm_dir()}/gfx942/fmha_v3_bwd/codegen.py --output_dir {{}}'",
            "f'{get_asm_dir()}/gfx950/fmha_v3_bwd/codegen.py --output_dir {{}}'",
            "f'{AITER_CSRC_DIR}/cpp_itfs/mha_bwd_generate.py --receipt 2 --output_dir {{}}'"
        ]
    },
    "module_fmha_v3_varlen_bwd": {
        "srcs": [
            "f'{AITER_CSRC_DIR}/kernels/mha_common.cu'",
            "f'{AITER_CSRC_DIR}/py_itfs_cu/asm_mha_varlen_bwd.cu'"
        ],
        "flags_extra_cc": [],
        "flags_extra_hip": [
            "'-DCK_TILE_FMHA_FWD_FAST_EXP2=1'"
        ],
        "extra_ldflags": [],
        "extra_include": [
            "f'{CK_DIR}/example/ck_tile/01_fmha'"
        ],
        "verbose": "False",
        "blob_gen_cmd": [
            "f'{AITER_CSRC_DIR}/py_itfs_cu/fmha_bwd_pre_post_kernel_generate.py --filter \"*@*_ndeterministic@*_nbias*_dropout*_ndeterministic*\" --output_dir {{}}'",
            "f'{get_asm_dir()}/gfx942/fmha_v3_bwd/codegen.py --output_dir {{}}'",
            "f'{get_asm_dir()}/gfx950/fmha_v3_bwd/codegen.py --output_dir {{}}'",
            "f'{AITER_CSRC_DIR}/cpp_itfs/mha_bwd_generate.py --receipt 2 --output_dir {{}}'"
        ]
    },
    "module_fmha_v3_varlen_fwd": {
        "srcs": [
            "f'{AITER_CSRC_DIR}/kernels/mha_common.cu'",
            "f'{AITER_CSRC_DIR}/py_itfs_cu/asm_mha_varlen_fwd.cu'"
        ],
        "flags_extra_cc": [],
        "flags_extra_hip": [
            "'-DCK_TILE_FMHA_FWD_FAST_EXP2=1'"
        ],
        "extra_ldflags": [],
        "extra_include": [
            "f'{CK_DIR}/example/ck_tile/01_fmha'"
        ],
        "verbose": "False",
        "blob_gen_cmd": [
            "f'{AITER_CSRC_DIR}/cpp_itfs/mha_fwd_generate.py --receipt 1 --output_dir {{}}'",
            "f'{get_asm_dir()}/gfx942/fmha_v3_fwd/codegen.py --output_dir {{}}'",
            "f'{get_asm_dir()}/gfx950/fmha_v3_fwd/codegen.py --output_dir {{}}'"
        ]
    },
    "module_mha_bwd": {
        "srcs": [
            "f'{AITER_CSRC_DIR}/kernels/mha_common.cu'",
            "f'{AITER_CSRC_DIR}/py_itfs_ck/mha_bwd_kernels.cu'"
        ],
        "flags_extra_cc": [],
        "flags_extra_hip": [
            "'-DCK_TILE_FMHA_FWD_FAST_EXP2=1'",
            "f'-DCK_TILE_FLOAT_TO_BFLOAT16_DEFAULT={os.environ.get(\"CK_TILE_FLOAT_TO_BFLOAT16_DEFAULT\", 2)}'"
        ],
        "extra_ldflags": [],
        "extra_include": [
            "f'{CK_DIR}/example/ck_tile/01_fmha'"
        ],
        "verbose": "False",
        "hip_clang_path": "os.environ.get('MHA_HIP_CLANG_PATH')",
        "blob_gen_cmd": [
            "f'{CK_DIR}/example/ck_tile/01_fmha/generate.py -d bwd --receipt 600 --output_dir {{}}'",
            "f'{AITER_CSRC_DIR}/cpp_itfs/mha_bwd_generate.py --receipt 3 --output_dir {{}}'"
        ]
    },
    "module_mha_varlen_bwd": {
        "srcs": [
            "f'{AITER_CSRC_DIR}/kernels/mha_common.cu'",
            "f'{AITER_CSRC_DIR}/py_itfs_ck/mha_varlen_bwd_kernels.cu'"
        ],
        "flags_extra_cc": [],
        "flags_extra_hip": [
            "'-DCK_TILE_FMHA_FWD_FAST_EXP2=1'",
            "f'-DCK_TILE_FLOAT_TO_BFLOAT16_DEFAULT={os.environ.get(\"CK_TILE_FLOAT_TO_BFLOAT16_DEFAULT\", 2)}'"
        ],
        "extra_ldflags": [],
        "extra_include": [
            "f'{CK_DIR}/example/ck_tile/01_fmha'"
        ],
        "verbose": "False",
        "hip_clang_path": "os.environ.get('MHA_HIP_CLANG_PATH')",
        "blob_gen_cmd": [
            "f'{CK_DIR}/example/ck_tile/01_fmha/generate.py -d bwd --receipt 600 --output_dir {{}}'",
            "f'{AITER_CSRC_DIR}/cpp_itfs/mha_bwd_generate.py --receipt 3 --output_dir {{}}'"
        ]
    },
    "libmha_fwd": {
        "srcs": [],
        "flags_extra_cc": [],
        "flags_extra_hip": [
            "'-DCK_TILE_FMHA_FWD_FAST_EXP2=1'",
            "f'-DCK_TILE_FLOAT_TO_BFLOAT16_DEFAULT={os.environ.get(\"CK_TILE_FLOAT_TO_BFLOAT16_DEFAULT\", 2)}'",
            "'-DCK_TILE_FMHA_FWD_SPLITKV_API=1'"
        ],
        "extra_ldflags": [],
        "extra_include": [
            "f'{CK_DIR}/example/ck_tile/01_fmha'"
        ],
        "verbose": "False",
        "is_python_module": "False",
        "torch_exclude": "True",
        "blob_gen_cmd": [
            "f'{CK_DIR}/example/ck_tile/01_fmha/generate.py -d fwd --receipt 600 --output_dir {{}}'",
            "f'{CK_DIR}/example/ck_tile/01_fmha/generate.py -d fwd_splitkv --receipt 600 --output_dir {{}}'",
            "f'{CK_DIR}/example/ck_tile/01_fmha/generate.py -d batch_prefill --receipt 600 --output_dir {{}}'",
            "f'{AITER_CSRC_DIR}/cpp_itfs/mha_fwd_generate.py --receipt 5 --output_dir {{}}'",
            "f'{get_asm_dir()}/gfx942/fmha_v3_fwd/codegen.py --output_dir {{}}'",
            "f'{get_asm_dir()}/gfx950/fmha_v3_fwd/codegen.py --output_dir {{}}'"
        ]
    },
    "libmha_bwd": {
        "srcs": [],
        "flags_extra_cc": [],
        "flags_extra_hip": [
            "f'-DCK_TILE_FLOAT_TO_BFLOAT16_DEFAULT={os.environ.get(\"CK_TILE_FLOAT_TO_BFLOAT16_DEFAULT\", 0)}'"
        ],
        "extra_ldflags": [],
        "extra_include": [
            "f'{CK_DIR}/example/ck_tile/01_fmha'"
        ],
        "verbose": "False",
        "is_python_module": "False",
        "torch_exclude": "True",
        "blob_gen_cmd": [
            "f'{CK_DIR}/example/ck_tile/01_fmha/generate.py -d bwd --receipt 600 --output_dir {{}}'",
            "f'{AITER_CSRC_DIR}/py_itfs_cu/fmha_bwd_pre_post_kernel_generate.py --filter \"*@*_ndeterministic@*_nbias*_dropout*_ndeterministic*\" --output_dir {{}}'",
            "f'{get_asm_dir()}/gfx942/fmha_v3_bwd/codegen.py --output_dir {{}}'",
            "f'{get_asm_dir()}/gfx950/fmha_v3_bwd/codegen.py --output_dir {{}}'",
            "f'{AITER_CSRC_DIR}/cpp_itfs/mha_bwd_generate.py --receipt 3 --output_dir {{}}'"
        ]
    }
}
